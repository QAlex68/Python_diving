# –ú–µ—Ç–æ–¥—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ
# –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ñ–∞–π–ª–æ–º –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º
# —Ñ–∞–π–ª–µ. –î–µ–π—Å—Ç–≤–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞—é—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞ –≤ —Å—Ç—Ä–æ–∫–µ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ –≤–ª–µ–≤–æ –∏
# –≤–ø—Ä–∞–≤–æ.
# ‚óè –ú–µ—Ç–æ–¥ tell
# –ú–µ—Ç–æ–¥ tell –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –≤ —Ñ–∞–π–ª–µ.
text = ['Lorem ipsum dolor sit amet, consectetur adipisicing elit.',
        'Consequatur debitis explicabo laboriosam sint suscipit temporibus veniam?',
        'Accusantium alias amet fugit iste neque non odit quia saepe totam velit?', ]
with open('new_data.txt', 'w', encoding='utf-8') as f:
    print(f.tell())
    for line in text:
        f.write(f'{line}\n')
        print(f.tell())
    print(f.tell())
# print(f.tell()) # ValueError: I/O operation on closed file.
# –î–ª—è –ø—É—Å—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–æ–ª—å ‚Äî –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞. –ü–æ –º–µ—Ä–µ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ —á—Ç–µ–Ω–∏—è
# –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ–∑–∏—Ü–∏—è —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è –∫ –∫–æ–Ω—Ü—É —Ñ–∞–π–ª–∞.
# –ú–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É—é –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤ –∫–∞–∫–æ–º –º–µ—Å—Ç–µ —Ñ–∞–π–ª–∞ –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω—ã —á—Ç–µ–Ω–∏–µ –∏–ª–∏ –∑–∞–ø–∏—Å—å.

# ‚óè –ú–µ—Ç–æ–¥ seek
# –ú–µ—Ç–æ–¥ seek –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ ‚Äú–∫—É—Ä—Å–æ—Ä–∞‚Äù –≤ —Ñ–∞–π–ª–µ.
# seek(offset, whence=0), –≥–¥–µ offset ‚Äî —Å–º–µ—â–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–ø–æ—Ä–Ω–æ–π —Ç–æ—á–∫–∏, whence -
# —Å–ø–æ—Å–æ–± –≤—ã–±–æ—Ä–∞ –æ–ø–æ—Ä–æ–Ω–æ–π —Ç–æ—á–∫–∏.
# ‚óè whence = 0 - –æ—Ç—Å—á—ë—Ç –æ—Ç –Ω–∞—á–∞–ª–∞ —Ñ–∞–π–ª–∞
# ‚óè whence = 1 - –æ—Ç—Å—á—ë—Ç –æ—Ç —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏ –≤ —Ñ–∞–π–ª–µ
# ‚óè whence = 2 - –æ—Ç—Å—á—ë—Ç –æ—Ç –∫–æ–Ω—Ü–∞ —Ñ–∞–π–ª–∞
# üî• –í–∞–∂–Ω–æ! –ó–Ω–∞—á–µ–Ω–∏—è 1 –∏ 2 –¥–æ–ø—É—Å—Ç–∏–º—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∏–Ω–∞—Ä–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ seek(0, 2) –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞
# –≤ –∫–æ–Ω–µ—Ü —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞.
# –ú–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é ‚Äú–∫—É—Ä—Å–æ—Ä–∞‚Äù.
last = before = 0
text = ['Lorem ipsum dolor sit amet, consectetur adipisicing elit.',
        'Consequatur debitis explicabo laboriosam sint suscipit temporibus veniam?',
        'Accusantium alias amet fugit iste neque non odit quia saepe totam velit?', ]
with open('new_data.txt', 'r+', encoding='utf-8') as f:
    while line := f.readline():
        last, before = f.tell(), last
    print(f'{last = }, {before = }')
    print(f'{f.seek(before, 0) = }')
    f.write('\n'.join(text))
# –í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ –º—ã –æ—Ç–∫—Ä—ã–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏.
# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ last –∏ before —Ö—Ä–∞–Ω—è—Ç –ø–æ–∑–∏—Ü–∏–∏ –¥–≤—É—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫.
# –î–æ—á–∏—Ç–∞–≤ —Ñ–∞–π–ª –≤ —Ü–∏–∫–ª–µ while –¥–æ –∫–æ–Ω—Ü–∞ –∏–∑–º–µ–Ω—è–µ–º –ø–æ–∑–∏—Ü–∏—é ‚Äú–∫—É—Ä—Å–æ—Ä–∞‚Äù –Ω–∞ –Ω–∞—á–∞–ª–æ
# –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ –∏ –Ω–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–∏—Å—å. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏
# —Ñ–∞–π–ª–∞ –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏ –∑–∞–ø–∏—Å–∞–ª–∏ –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç –≤ –∫–æ–Ω–µ—Ü.

# ‚óè –ú–µ—Ç–æ–¥ truncate
# truncate(size=None) ‚Äî –º–µ—Ç–æ–¥ –∏–∑–º–µ–Ω—è–µ—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞. –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤
# –ø–∞—Ä–∞–º–µ—Ç—Ä size –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ —á–∞—Å—Ç—å —Ñ–∞–π–ª–∞ –æ—Ç —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏ –¥–æ –∫–æ–Ω—Ü–∞. –ú–µ—Ç–æ–¥
# –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞.
last = before = 0
with open('new_data.txt', 'r+', encoding='utf-8') as f:
    while line := f.readline():
        last, before = f.tell(), last
    print(f.seek(before, 0))
    print(f.truncate())
# –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä size –º–µ—Ç–æ–¥ –∏–∑–º–µ–Ω—è–µ—Ç —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞
# —Å–∏–º–≤–æ–ª–æ–≤ –∏–ª–∏ –±–∞–π—Ç –æ—Ç –Ω–∞—á–∞–ª–∞ —Ñ–∞–π–ª–∞.
size = 64
with open('new_data.txt', 'r+', encoding='utf-8') as f:
    print(f.truncate(size))
# –ï—Å–ª–∏ size –º–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞, –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É—Å–µ—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞. –ï—Å–ª–∏ size –±–æ–ª—å—à–µ
# —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞, –æ–Ω —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. –ü—Ä–∏ —ç—Ç–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–π
# —Ä–∞–∑–º–µ—Ä –æ–±—ã—á–Ω–æ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω—É–ª–µ–≤—ã–º–∏ –±–∞–π—Ç–∞–º–∏. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –û–°.

# –ó–∞–¥–∞–Ω–∏–µ
# –ü–µ—Ä–µ–¥ –≤–∞–º–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞. –ß—Ç–æ –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
# —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã? –ò —á—Ç–æ –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–æ –Ω–∞ –ø–µ—á–∞—Ç—å? –£ –≤–∞—Å 3 –º–∏–Ω—É—Ç—ã.
start = 10
stop = 100
with open('data.bin', 'bw+') as f:
    for i in range(start, stop + 1):
        f.write(str(i).encode('utf-8'))
        if i % 3 == 0:
            f.seek(-2, 1)
    f.truncate(stop)
    f.seek(0)
    res = f.read(start)
    print(res.decode('utf-8'))
